<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LogiConnect – Chat logistique partagé</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
:root{
  --bg:#0b1220;
  --panel:#111a2e;
  --accent:#4facfe;
  --text:#ffffff;
  --muted:#9aa4bf;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Segoe UI',Roboto,Arial,sans-serif;
  background:linear-gradient(120deg,#0b1220,#020409);
  color:var(--text);
}
header{
  padding:32px 16px;
  text-align:center;
  background:linear-gradient(135deg,#203a43,#0f2027);
}
header h1{margin:0;font-size:2.2rem}
header p{margin-top:8px;color:var(--muted)}
section{padding:24px}
.container{
  max-width:1200px;
  margin:0 auto;
  display:grid;
  grid-template-columns:380px 1fr;
  gap:20px;
}
.box{
  background:var(--panel);
  border-radius:16px;
  padding:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}
.box h3{margin-top:0;color:var(--accent)}
label{font-size:.85rem;color:var(--muted)}
input,textarea,select,button{
  width:100%;
  margin-top:8px;
  padding:12px 14px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.08);
  background:#0c1426;
  color:var(--text);
}
textarea{resize:vertical;min-height:110px}
button{
  margin-top:14px;
  background:linear-gradient(135deg,#4facfe,#00f2fe);
  color:#000;
  font-weight:600;
  cursor:pointer;
  transition:transform .1s ease,box-shadow .1s ease;
}
button:hover{transform:translateY(-1px);box-shadow:0 8px 20px rgba(79,172,254,.35)}
.chat-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.messages{
  height:420px;
  overflow-y:auto;
  padding-right:6px;
}
.message{
  background:rgba(255,255,255,.05);
  border-radius:14px;
  padding:12px 14px;
  margin-bottom:10px;
}
.message strong{display:block}
.message .role{font-size:.75rem;color:var(--accent)}
.message p{margin:6px 0 0;line-height:1.4}
@media(max-width:900px){
  .container{grid-template-columns:1fr}
}
</style>
</head>
<body>

<header>
  <h1>LogiConnect</h1>
  <p>Chat partagé entre métiers de la logistique</p>
</header>

<section>
  <div class="container">

    <div class="box">
      <h3>Envoyer un message</h3>
      <input id="name" placeholder="Nom" />
      <select id="role">
        <option value="Logisticien">Logisticien</option>
        <option value="Organisateur">Organisateur</option>
        <option value="Chauffeur">Chauffeur</option>
        <option value="Mecanicien">Mécanicien</option>
        <option value="Etudiant">Étudiant</option>
      </select>
      <textarea id="content" placeholder="Message..."></textarea>
      <button onclick="sendMessage()">Envoyer</button>
    </div>

    <div class="box">
      <h3>Messages (temps réel)</h3>
      <select id="view" onchange="renderMessages()">
        <option value="ALL">Tous</option>
        <option value="Logisticien">Logisticiens</option>
        <option value="Organisateur">Organisateurs</option>
        <option value="Chauffeur">Chauffeurs</option>
        <option value="Mecanicien">Mécaniciens</option>
        <option value="Etudiant">Étudiants</option>
      </select>
      <div class="messages" id="messages"></div>
    </div>

  </div>
</section>

<script>
  // ✅ Configuration Firebase (Realtime Database)
  const firebaseConfig = {
    apiKey: "AIzaSyBLbswX9MiSInVqNW12POJ5OmAYKgy2ERw",
    authDomain: "projet-56900.firebaseapp.com",
    databaseURL: "https://projet-56900-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "projet-56900",
    storageBucket: "projet-56900.appspot.com",
    messagingSenderId: "753669702381",
    appId: "1:753669702381:web:0ac180682fba00c68542e4"
  };

  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
  const messagesRef = database.ref('messages');

  let allMessages = [];

  function sendMessage() {
    const name = document.getElementById('name').value;
    const role = document.getElementById('role').value;
    const content = document.getElementById('content').value;

    if (!name || !content) return alert('Champs requis');

    messagesRef.push({
      name,
      role,
      content,
      timestamp: Date.now()
    });

    document.getElementById('content').value = '';
  }

  messagesRef.on('value', snapshot => {
    allMessages = [];
    snapshot.forEach(child => {
      allMessages.push(child.val());
    });
    renderMessages();
  });

  function renderMessages() {
    const view = document.getElementById('view').value;
    const container = document.getElementById('messages');
    container.innerHTML = '';

    allMessages
      .sort((a,b)=>a.timestamp-b.timestamp)
      .forEach(msg => {
        if (view !== 'ALL' && msg.role !== view) return;
        const div = document.createElement('div');
        div.className = 'message';
        div.innerHTML = `<strong>${msg.name}</strong> (${msg.role})<p>${msg.content}</p>`;
        container.appendChild(div);
      });
  }
</script>

</body>
</html>

