<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>LogiSupport</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0b0e13;
  --panel:#151a22;
  --panel2:#1d2330;
  --border:#2e3646;
  --text:#e8ebf0;
  --muted:#9aa3af;
  --accent:#9fa6b2;
  --danger:#ff6b6b;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:radial-gradient(circle at top,#1a2030,#0b0e13 65%);
  color:var(--text);
}
header{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:12px;
  padding:18px;
  border-bottom:1px solid var(--border);
}
.logo-icon{
  width:44px;height:44px;
  border-radius:14px;
  background:linear-gradient(135deg,#b4bac6,#7b8394);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#0b0e13;
  font-weight:900;
}
.logo-text{
  font-size:1.9rem;
  letter-spacing:.12em;
  font-weight:800;
  color:var(--accent);
}
nav{
  display:flex;
  justify-content:center;
  gap:8px;
  padding:10px;
  border-bottom:1px solid var(--border);
}
nav button{
  background:var(--panel);
  color:var(--text);
  border:1px solid var(--border);
  padding:8px 16px;
  border-radius:12px;
  cursor:pointer;
  transition:.2s;
}
nav button:hover{background:var(--panel2)}
nav button.active{background:var(--panel2)}
.box{
  max-width:900px;
  margin:16px auto;
  padding:16px;
  background:linear-gradient(180deg,var(--panel2),var(--panel));
  border:1px solid var(--border);
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.4);
}
.hidden{display:none}
input,textarea,select{
  width:100%;
  padding:12px;
  margin-top:10px;
  background:#0b0e13;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:12px;
}
button.main{
  margin-top:12px;
  padding:12px;
  width:100%;
  background:linear-gradient(135deg,#b8beca,#7e8696);
  border:none;
  border-radius:12px;
  font-weight:800;
  color:#0b0e13;
  cursor:pointer;
}
.messages{
  height:340px;
  overflow-y:auto;
  padding:10px;
  background:#0b0e13;
  border-radius:12px;
  border:1px solid var(--border);
}
.message{
  padding:10px;
  margin-bottom:8px;
  background:var(--panel);
  border-radius:12px;
  position:relative;
}
.message.me{background:#232b3a}
.message small{
  display:block;
  font-size:.75rem;
  color:var(--muted);
  margin-top:4px;
}
.delete{
  position:absolute;
  top:6px;
  right:6px;
  background:var(--danger);
  border:none;<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>LogiSupport • Plateforme Professionnelle</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='black'/><text x='50%' y='60%' text-anchor='middle' font-size='60' fill='white'>LS</text></svg>">
<style>
:root{
 --bg:#0a0d14;--panel:#141926;--panel2:#1b2233;--border:#2a3142;
 --text:#eef1f7;--muted:#9aa3af;--accent:#6da7ff;--danger:#ff6b6b;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Segoe UI,Arial;background:radial-gradient(circle at top,#1b2238,#0a0d14 70%);color:var(--text)}
header{display:flex;align-items:center;justify-content:center;gap:14px;padding:18px;border-bottom:1px solid var(--border)}
.logo{width:48px;height:48px;border-radius:14px;background:linear-gradient(135deg,#6da7ff,#9fbfff);display:flex;align-items:center;justify-content:center;color:#000;font-weight:900}
nav{display:flex;gap:8px;justify-content:center;padding:10px;border-bottom:1px solid var(--border);flex-wrap:wrap}
nav button{background:var(--panel);color:var(--text);border:1px solid var(--border);padding:8px 16px;border-radius:12px;cursor:pointer}
nav button.active{background:var(--panel2);border-color:var(--accent)}
.box{max-width:1000px;margin:16px auto;padding:18px;background:linear-gradient(180deg,var(--panel2),var(--panel));border:1px solid var(--border);border-radius:18px;box-shadow:0 15px 40px rgba(0,0,0,.45)}
.hidden{display:none}
input,textarea,select{width:100%;padding:12px;margin-top:10px;background:#0a0d14;color:var(--text);border:1px solid var(--border);border-radius:12px}
button.main{margin-top:12px;padding:12px;width:100%;background:linear-gradient(135deg,#6da7ff,#9fbfff);border:none;border-radius:12px;font-weight:800;color:#000;cursor:pointer}
.chat-layout{display:grid;grid-template-columns:240px 1fr;gap:12px}
.rooms{background:#0a0d14;border:1px solid var(--border);border-radius:14px;padding:10px}
.rooms button{width:100%;margin-bottom:6px}
.messages{height:360px;overflow-y:auto;padding:10px;background:#0a0d14;border-radius:14px;border:1px solid var(--border)}
.message{padding:10px;margin-bottom:8px;background:var(--panel);border-radius:14px;position:relative}
.message.me{background:#222b40}
.message img{width:32px;height:32px;border-radius:50%;vertical-align:middle;margin-right:6px}
.message small{display:block;font-size:.75rem;color:var(--muted);margin-top:4px}
.delete{position:absolute;top:6px;right:6px;background:var(--danger);border:none;border-radius:6px;color:#fff;padding:2px 6px;cursor:pointer}
.badge{display:inline-block;background:#2ecc71;color:#000;padding:2px 6px;border-radius:6px;font-size:.7rem;margin-left:6px}
.admin-card{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
.stat{background:#0a0d14;border:1px solid var(--border);border-radius:14px;padding:14px;text-align:center}
footer{text-align:center;padding:30px;color:var(--muted)}
</style>
</head>
<body>
<header>
 <div class="logo">LS</div>
 <h1>LogiSupport</h1>
</header>
<nav>
 <button id="tabAuth" class="active" onclick="showTab('auth')">Connexion</button>
 <button id="tabChat" onclick="showTab('chat')">Chats</button>
 <button id="tabProfile" onclick="showTab('profile')">Profil</button>
 <button id="tabAdmin" class="hidden" onclick="showTab('admin')">Admin</button>
</nav>

<section id="auth" class="box">
 <input id="email" placeholder="Email">
 <input id="password" type="password" placeholder="Mot de passe">
 <select id="roleRegister">
  <option value="">Rôle</option>
  <option>Chauffeur</option><option>Logisticien</option><option>Organisateur</option><option>Mécanicien</option>
 </select>
 <button class="main" onclick="login()">Connexion</button>
 <button class="main" onclick="register()">Inscription</button>
</section>

<section id="chat" class="box hidden">
 <div class="chat-layout">
  <div class="rooms" id="rooms"></div>
  <div>
   <div class="messages" id="messages"></div>
   <textarea id="content" placeholder="Message"></textarea>
   <button class="main" onclick="sendMessage()">Envoyer</button>
  </div>
 </div>
</section>

<section id="profile" class="box hidden">
 <input id="pName" placeholder="Nom">
 <input id="pRole" disabled>
 <input type="file" id="avatar">
 <button class="main" onclick="saveProfile()">Sauvegarder</button>
</section>

<section id="admin" class="box hidden">
 <div class="admin-card">
  <div class="stat"><h3 id="statUsers">0</h3><p>Utilisateurs</p></div>
  <div class="stat"><h3 id="statMessages">0</h3><p>Messages</p></div>
  <div class="stat"><h3>Realtime</h3><p>Base Firebase</p></div>
 </div>
 <h3>Audit log</h3>
 <div class="messages" id="audit"></div>
</section>

<footer>LogiSupport • Projet professionnel sécurisé • Firebase</footer>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig={apiKey:"AIzaSyBLbswX9MiSInVqNW12POJ5OmAYKgy2ERw",authDomain:"projet-56900.firebaseapp.com",databaseURL:"https://projet-56900-default-rtdb.europe-west1.firebasedatabase.app",projectId:"projet-56900",messagingSenderId:"753669702381",appId:"1:753669702381:web:0ac180682fba00c68542e4"};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(),db=firebase.database();
let currentUser,currentRole,currentRoom;
const ROOMS=["Global","Chauffeur","Logisticien","Organisateur","Mécanicien"];
function showTab(id){document.querySelectorAll('section').forEach(s=>s.classList.add('hidden'));document.getElementById(id).classList.remove('hidden');document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));document.getElementById('tab'+id.charAt(0).toUpperCase()+id.slice(1)).classList.add('active')}
function login(){auth.signInWithEmailAndPassword(email.value,password.value).catch(alert)}
function register(){if(!roleRegister.value)return alert('Choisissez un rôle');auth.createUserWithEmailAndPassword(email.value,password.value).then(c=>db.ref('users/'+c.user.uid).set({name:'User',role:roleRegister.value,avatar:''})).catch(alert)}
auth.onAuthStateChanged(u=>{if(!u)return;currentUser=u;db.ref('users/'+u.uid).on('value',s=>{const d=s.val();currentRole=d.role;pName.value=d.name;pRole.value=d.role;tabAdmin.classList.toggle('hidden',d.role!=="Administrateur");loadRooms();loadStats()});showTab('chat')});
function loadRooms(){rooms.innerHTML='';ROOMS.forEach(r=>{if(r==='Global'||r===currentRole||currentRole==='Administrateur'){const b=document.createElement('button');b.textContent=r;b.onclick=()=>{currentRoom=r;loadMessages()};rooms.appendChild(b)}});currentRoom=currentRoom||'Global';loadMessages()}
function sendMessage(){if(!content.value)return;db.ref('messages/'+currentRoom).push({uid:currentUser.uid,name:pName.value,role:currentRole,text:content.value,time:new Date().toLocaleString()});content.value=''}
function loadMessages(){const ref=db.ref('messages/'+currentRoom);ref.off();ref.on('value',s=>{messages.innerHTML='';s.forEach(c=>{const m=c.val();const d=document.createElement('div');d.className='message'+(m.uid===currentUser.uid?' me':'');d.innerHTML=`<b>${m.name}</b> (${m.role})<br>${m.text}<small>${m.time}</small>`;if(m.uid===currentUser.uid||currentRole==='Administrateur'){const x=document.createElement('button');x.textContent='×';x.className='delete';x.onclick=()=>c.ref.remove();d.appendChild(x)}messages.appendChild(d)});messages.scrollTop=messages.scrollHeight})}
function saveProfile(){db.ref('users/'+currentUser.uid+'/name').set(pName.value)}
function loadStats(){db.ref('users').once('value',s=>statUsers.textContent=s.numChildren());db.ref('messages').once('value',s=>{let c=0;s.forEach(r=>c+=r.numChildren());statMessages.textContent=c})}
</script>
</body>
</html>
